<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Portfolio Admin Dashboard</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <!-- Cloudinary Upload Widget -->
    <script src="https://upload-widget.cloudinary.com/global/all.js" type="text/javascript"></script>
    
    <!-- Standardized API Hooks -->
    <script src="js/api-consolidator.js"></script>
    <script src="js/standardized-hooks.js"></script>
    
    <!-- COMPLETE CASE STUDIES FIX - THOROUGH SOLUTION -->
    <script src="complete-case-studies-fix.js"></script>
    <style>
        .sidebar-transition {
            transition: transform 0.3s ease-in-out;
        }
        
        .card-hover {
            transition: all 0.3s ease;
        }
        
        .card-hover:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
        }
        
        .metric-card {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        }
        
        .activity-item {
            transition: all 0.2s ease;
        }
        
        .activity-item:hover {
            background-color: #f8fafc;
        }
        
        .permission-badge {
            display: inline-flex;
            align-items: center;
            padding: 0.25rem 0.75rem;
            border-radius: 9999px;
            font-size: 0.75rem;
            font-weight: 500;
        }
        
        .permission-admin {
            background-color: #fef3c7;
            color: #92400e;
        }
        
        .permission-editor {
            background-color: #dbeafe;
            color: #1e40af;
        }
        
        .permission-viewer {
            background-color: #f3e8ff;
            color: #7c3aed;
        }
        
        .security-indicator {
            position: relative;
            overflow: hidden;
        }
        
        .security-indicator::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
            animation: shimmer 2s infinite;
        }
        
        @keyframes shimmer {
            0% { left: -100%; }
            100% { left: 100%; }
        }
    </style>
</head>
<body class="bg-gray-50">
    <!-- Sidebar -->
    <div id="sidebar" class="fixed inset-y-0 left-0 z-50 w-64 bg-white shadow-lg sidebar-transition transform -translate-x-full lg:translate-x-0">
        <div class="flex items-center justify-center h-16 bg-gradient-to-r from-blue-600 to-purple-600">
            <div class="flex items-center space-x-2">
                <i class="fas fa-magic text-white text-xl"></i>
                <span class="text-white text-xl font-bold">Portfolio Admin</span>
            </div>
        </div>
        
        <nav class="mt-8">
            <div class="px-4 space-y-2">
                <a href="#dashboard" class="nav-item flex items-center px-4 py-3 text-gray-700 rounded-lg hover:bg-gray-100 active">
                    <i class="fas fa-tachometer-alt mr-3"></i>
                    Dashboard
                </a>
                <a href="#projects" class="nav-item flex items-center px-4 py-3 text-gray-700 rounded-lg hover:bg-gray-100">
                    <i class="fas fa-folder-open mr-3"></i>
                    Projects
                </a>
                <a href="#case-studies" class="nav-item flex items-center px-4 py-3 text-gray-700 rounded-lg hover:bg-gray-100">
                    <i class="fas fa-book mr-3"></i>
                    Case Studies
                </a>
                <a href="#carousel" class="nav-item flex items-center px-4 py-3 text-gray-700 rounded-lg hover:bg-gray-100">
                    <i class="fas fa-images mr-3"></i>
                    Carousel
                </a>
                <a href="#content" class="nav-item flex items-center px-4 py-3 text-gray-700 rounded-lg hover:bg-gray-100">
                    <i class="fas fa-edit mr-3"></i>
                    Content
                </a>
                <a href="case_study_editor_complete.html" class="nav-item flex items-center px-4 py-3 text-gray-700 rounded-lg hover:bg-gray-100">
                    <i class="fas fa-magic mr-3"></i>
                    Case Study Editor
                </a>
                <a href="#analytics" class="nav-item flex items-center px-4 py-3 text-gray-700 rounded-lg hover:bg-gray-100">
                    <i class="fas fa-chart-bar mr-3"></i>
                    Analytics
                </a>
                <a href="#users" class="nav-item flex items-center px-4 py-3 text-gray-700 rounded-lg hover:bg-gray-100">
                    <i class="fas fa-users mr-3"></i>
                    User Management
                </a>
                <a href="#api" class="nav-item flex items-center px-4 py-3 text-gray-700 rounded-lg hover:bg-gray-100">
                    <i class="fas fa-key mr-3"></i>
                    API Keys
                </a>
                <a href="#backups" class="nav-item flex items-center px-4 py-3 text-gray-700 rounded-lg hover:bg-gray-100">
                    <i class="fas fa-database mr-3"></i>
                    Backups
                </a>
                <a href="#integrations" class="nav-item flex items-center px-4 py-3 text-gray-700 rounded-lg hover:bg-gray-100">
                    <i class="fas fa-plug mr-3"></i>
                    Integrations
                </a>
                <a href="#billing" class="nav-item flex items-center px-4 py-3 text-gray-700 rounded-lg hover:bg-gray-100">
                    <i class="fas fa-credit-card mr-3"></i>
                    Billing
                </a>
                <a href="#support" class="nav-item flex items-center px-4 py-3 text-gray-700 rounded-lg hover:bg-gray-100">
                    <i class="fas fa-life-ring mr-3"></i>
                    Support
                </a>
                <a href="#settings" class="nav-item flex items-center px-4 py-3 text-gray-700 rounded-lg hover:bg-gray-100">
                    <i class="fas fa-cog mr-3"></i>
                    Settings
                </a>
            </div>
            
            <div class="px-4 mt-8">
                <div class="border-t pt-4">
                    <a href="#security" class="nav-item flex items-center px-4 py-3 text-gray-700 rounded-lg hover:bg-gray-100">
                        <i class="fas fa-shield-alt mr-3"></i>
                        Security
                    </a>
                    <a href="#profile" class="nav-item flex items-center px-4 py-3 text-gray-700 rounded-lg hover:bg-gray-100">
                        <i class="fas fa-user mr-3"></i>
                        Profile
                    </a>
                </div>
            </div>
        </nav>
    </div>

    <!-- Main Content -->
    <div class="lg:ml-64">
        <!-- Top Bar -->
        <header class="bg-white shadow-sm border-b">
            <div class="flex items-center justify-between px-6 py-4">
                <div class="flex items-center space-x-4">
                    <button id="sidebarToggle" class="lg:hidden text-gray-600 hover:text-gray-900">
                        <i class="fas fa-bars text-xl"></i>
                    </button>
                    <h1 id="pageTitle" class="text-2xl font-semibold text-gray-900">Dashboard</h1>
                </div>
                
                <div class="flex items-center space-x-4">
                    <!-- Notifications -->
                    <div class="relative">
                        <button id="notificationBtn" class="text-gray-600 hover:text-gray-900 relative">
                            <i class="fas fa-bell text-xl"></i>
                            <span id="notificationBadge" class="absolute -top-2 -right-2 bg-red-500 text-white text-xs rounded-full h-5 w-5 flex items-center justify-center hidden">3</span>
                        </button>
                    </div>
                    
                    <!-- User Menu -->
                    <div class="relative">
                        <button id="userMenuBtn" class="flex items-center space-x-2 text-gray-700 hover:text-gray-900">
                            <img id="userAvatar" src="https://via.placeholder.com/32" alt="User" class="w-8 h-8 rounded-full">
                            <span id="userName" class="hidden md:block">Loading...</span>
                            <i class="fas fa-chevron-down text-sm"></i>
                        </button>
                        
                        <!-- Dropdown Menu -->
                        <div id="userDropdown" class="absolute right-0 mt-2 w-48 bg-white rounded-lg shadow-lg border hidden z-10">
                            <div class="py-2">
                                <a href="#profile" class="block px-4 py-2 text-gray-700 hover:bg-gray-100">
                                    <i class="fas fa-user mr-2"></i>Profile
                                </a>
                                <a href="#settings" class="block px-4 py-2 text-gray-700 hover:bg-gray-100">
                                    <i class="fas fa-cog mr-2"></i>Settings
                                </a>
                                <a href="#security" class="block px-4 py-2 text-gray-700 hover:bg-gray-100">
                                    <i class="fas fa-shield-alt mr-2"></i>Security
                                </a>
                                <div class="border-t my-2"></div>
                                <button id="logoutBtn" class="block w-full text-left px-4 py-2 text-red-600 hover:bg-red-50">
                                    <i class="fas fa-sign-out-alt mr-2"></i>Logout
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </header>

        <!-- Page Content -->
        <main class="p-6">
            <!-- Dashboard View -->
            <div id="dashboardView" class="page-view">
                <!-- Metrics Cards -->
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8">
                    <div class="metric-card text-white rounded-xl p-6 card-hover">
                        <div class="flex items-center justify-between">
                            <div>
                                <p class="text-white text-opacity-80">Total Projects</p>
                                <p id="totalProjects" class="text-3xl font-bold">0</p>
                            </div>
                            <i class="fas fa-folder-open text-3xl text-white text-opacity-60"></i>
                        </div>
                    </div>
                    
                    <div class="bg-green-500 text-white rounded-xl p-6 card-hover">
                        <div class="flex items-center justify-between">
                            <div>
                                <p class="text-white text-opacity-80">Case Studies</p>
                                <p id="totalCaseStudies" class="text-3xl font-bold">0</p>
                            </div>
                            <i class="fas fa-book text-3xl text-white text-opacity-60"></i>
                        </div>
                    </div>
                    
                    <div class="bg-yellow-500 text-white rounded-xl p-6 card-hover">
                        <div class="flex items-center justify-between">
                            <div>
                                <p class="text-white text-opacity-80">Carousel Images</p>
                                <p id="totalCarouselImages" class="text-3xl font-bold">0</p>
                            </div>
                            <i class="fas fa-images text-3xl text-white text-opacity-60"></i>
                        </div>
                    </div>
                    
                    <div class="bg-red-500 text-white rounded-xl p-6 card-hover">
                        <div class="flex items-center justify-between">
                            <div>
                                <p class="text-white text-opacity-80">Page Views</p>
                                <p id="totalPageViews" class="text-3xl font-bold">0</p>
                            </div>
                            <i class="fas fa-eye text-3xl text-white text-opacity-60"></i>
                        </div>
                    </div>
                </div>

                <!-- Quick Actions -->
                <div class="grid grid-cols-1 lg:grid-cols-2 gap-6 mb-8">
                    <div class="bg-white rounded-xl shadow-sm p-6">
                        <h3 class="text-lg font-semibold text-gray-900 mb-4">Quick Actions</h3>
                        <div class="grid grid-cols-2 gap-4">
                            <button class="quick-action-btn flex flex-col items-center p-4 bg-blue-50 rounded-lg hover:bg-blue-100 transition-colors">
                                <i class="fas fa-plus text-blue-600 text-2xl mb-2"></i>
                                <span class="text-sm font-medium text-blue-600">New Project</span>
                            </button>
                            <button class="quick-action-btn flex flex-col items-center p-4 bg-green-50 rounded-lg hover:bg-green-100 transition-colors">
                                <i class="fas fa-book-open text-green-600 text-2xl mb-2"></i>
                                <span class="text-sm font-medium text-green-600">New Case Study</span>
                            </button>
                            <button class="quick-action-btn flex flex-col items-center p-4 bg-purple-50 rounded-lg hover:bg-purple-100 transition-colors">
                                <i class="fas fa-image text-purple-600 text-2xl mb-2"></i>
                                <span class="text-sm font-medium text-purple-600">Add Image</span>
                            </button>
                            <button class="quick-action-btn flex flex-col items-center p-4 bg-yellow-50 rounded-lg hover:bg-yellow-100 transition-colors">
                                <i class="fas fa-edit text-yellow-600 text-2xl mb-2"></i>
                                <span class="text-sm font-medium text-yellow-600">Edit Content</span>
                            </button>
                        </div>
                    </div>
                    
                    <div class="bg-white rounded-xl shadow-sm p-6">
                        <h3 class="text-lg font-semibold text-gray-900 mb-4">Recent Activity</h3>
                        <div id="recentActivity" class="space-y-3">
                            <!-- Activity items will be loaded here -->
                            <div class="flex items-center space-x-3 activity-item p-2 rounded">
                                <div class="w-2 h-2 bg-blue-500 rounded-full"></div>
                                <div class="flex-1">
                                    <p class="text-sm text-gray-900">Loading recent activity...</p>
                                    <p class="text-xs text-gray-500">Please wait</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- System Status -->
                <div class="bg-white rounded-xl shadow-sm p-6">
                    <h3 class="text-lg font-semibold text-gray-900 mb-4">System Status</h3>
                    <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                        <div class="text-center">
                            <div class="security-indicator inline-flex items-center justify-center w-12 h-12 bg-green-100 rounded-full mb-3">
                                <i class="fas fa-server text-green-600"></i>
                            </div>
                            <h4 class="font-medium text-gray-900">Server Status</h4>
                            <p id="serverStatus" class="text-sm text-green-600">Online</p>
                        </div>
                        <div class="text-center">
                            <div class="security-indicator inline-flex items-center justify-center w-12 h-12 bg-blue-100 rounded-full mb-3">
                                <i class="fas fa-database text-blue-600"></i>
                            </div>
                            <h4 class="font-medium text-gray-900">Database</h4>
                            <p id="databaseStatus" class="text-sm text-blue-600">Connected</p>
                        </div>
                        <div class="text-center">
                            <div class="security-indicator inline-flex items-center justify-center w-12 h-12 bg-purple-100 rounded-full mb-3">
                                <i class="fas fa-shield-alt text-purple-600"></i>
                            </div>
                            <h4 class="font-medium text-gray-900">Security</h4>
                            <p id="securityStatus" class="text-sm text-purple-600">Protected</p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Security View -->
            <div id="securityView" class="page-view hidden">
                <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                    <!-- Security Overview -->
                    <div class="bg-white rounded-xl shadow-sm p-6">
                        <h3 class="text-lg font-semibold text-gray-900 mb-4">Security Overview</h3>
                        <div class="space-y-4">
                            <div class="flex items-center justify-between p-3 bg-green-50 rounded-lg">
                                <div class="flex items-center space-x-3">
                                    <i class="fas fa-shield-alt text-green-600"></i>
                                    <span class="text-sm font-medium">Two-Factor Authentication</span>
                                </div>
                                <span class="text-xs bg-green-100 text-green-800 px-2 py-1 rounded-full">Enabled</span>
                            </div>
                            <div class="flex items-center justify-between p-3 bg-blue-50 rounded-lg">
                                <div class="flex items-center space-x-3">
                                    <i class="fas fa-lock text-blue-600"></i>
                                    <span class="text-sm font-medium">Password Strength</span>
                                </div>
                                <span class="text-xs bg-blue-100 text-blue-800 px-2 py-1 rounded-full">Strong</span>
                            </div>
                            <div class="flex items-center justify-between p-3 bg-yellow-50 rounded-lg">
                                <div class="flex items-center space-x-3">
                                    <i class="fas fa-clock text-yellow-600"></i>
                                    <span class="text-sm font-medium">Session Timeout</span>
                                </div>
                                <span class="text-xs bg-yellow-100 text-yellow-800 px-2 py-1 rounded-full">24 hours</span>
                            </div>
                        </div>
                    </div>

                    <!-- Active Sessions -->
                    <div class="bg-white rounded-xl shadow-sm p-6">
                        <h3 class="text-lg font-semibold text-gray-900 mb-4">Active Sessions</h3>
                        <div id="activeSessions" class="space-y-3">
                            <!-- Sessions will be loaded here -->
                        </div>
                    </div>

                    <!-- Security Logs -->
                    <div class="bg-white rounded-xl shadow-sm p-6 lg:col-span-2">
                        <h3 class="text-lg font-semibold text-gray-900 mb-4">Security Logs</h3>
                        <div id="securityLogs" class="space-y-2">
                            <!-- Logs will be loaded here -->
                        </div>
                    </div>
                </div>
            </div>

            <!-- Profile View -->
            <div id="profileView" class="page-view hidden">
                <div class="max-w-2xl mx-auto">
                    <div class="bg-white rounded-xl shadow-sm p-6">
                        <h3 class="text-lg font-semibold text-gray-900 mb-6">Profile Settings</h3>
                        
                        <form id="profileForm" class="space-y-6">
                            <div class="flex items-center space-x-6">
                                <div class="relative">
                                    <img id="profileAvatar" src="https://via.placeholder.com/80" alt="Profile" class="w-20 h-20 rounded-full">
                                    <button type="button" class="absolute bottom-0 right-0 bg-blue-600 text-white rounded-full w-6 h-6 flex items-center justify-center">
                                        <i class="fas fa-camera text-xs"></i>
                                    </button>
                                </div>
                                <div>
                                    <h4 class="font-medium text-gray-900">Profile Picture</h4>
                                    <p class="text-sm text-gray-500">Upload a new profile picture</p>
                                </div>
                            </div>

                            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2">Full Name</label>
                                    <input type="text" id="profileName" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2">Email</label>
                                    <input type="email" id="profileEmail" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                                </div>
                            </div>

                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">Role</label>
                                <div id="userRole" class="permission-badge permission-admin">
                                    <i class="fas fa-crown mr-1"></i>
                                    Administrator
                                </div>
                            </div>

                            <div class="flex justify-end space-x-3">
                                <button type="button" class="px-4 py-2 text-gray-700 bg-gray-100 rounded-lg hover:bg-gray-200">
                                    Cancel
                                </button>
                                <button type="submit" class="px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700">
                                    Save Changes
                                </button>
                            </div>
                        </form>
                    </div>

                    <!-- Change Password -->
                    <div class="bg-white rounded-xl shadow-sm p-6 mt-6">
                        <h3 class="text-lg font-semibold text-gray-900 mb-6">Change Password</h3>
                        
                        <form id="passwordForm" class="space-y-6">
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">Current Password</label>
                                <input type="password" id="currentPassword" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">New Password</label>
                                <input type="password" id="newPassword" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">Confirm New Password</label>
                                <input type="password" id="confirmNewPassword" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                            </div>

                            <div class="flex justify-end">
                                <button type="submit" class="px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700">
                                    Update Password
                                </button>
                            </div>
                        </form>
                    </div>
                </div>
            </div>

            <!-- Analytics View -->
            <div id="analyticsView" class="page-view hidden">
                <div class="grid grid-cols-1 lg:grid-cols-4 gap-6 mb-8">
                    <!-- Analytics Metrics -->
                    <div class="bg-white rounded-xl shadow-sm p-6">
                        <div class="flex items-center justify-between">
                            <div>
                                <p class="text-gray-500 text-sm">Page Views</p>
                                <p id="analyticsPageViews" class="text-2xl font-bold text-gray-900">0</p>
                            </div>
                            <i class="fas fa-eye text-blue-500 text-2xl"></i>
                        </div>
                    </div>
                    <div class="bg-white rounded-xl shadow-sm p-6">
                        <div class="flex items-center justify-between">
                            <div>
                                <p class="text-gray-500 text-sm">Unique Visitors</p>
                                <p id="analyticsUniqueVisitors" class="text-2xl font-bold text-gray-900">0</p>
                            </div>
                            <i class="fas fa-users text-green-500 text-2xl"></i>
                        </div>
                    </div>
                    <div class="bg-white rounded-xl shadow-sm p-6">
                        <div class="flex items-center justify-between">
                            <div>
                                <p class="text-gray-500 text-sm">Bounce Rate</p>
                                <p id="analyticsBounceRate" class="text-2xl font-bold text-gray-900">0%</p>
                            </div>
                            <i class="fas fa-chart-line text-yellow-500 text-2xl"></i>
                        </div>
                    </div>
                    <div class="bg-white rounded-xl shadow-sm p-6">
                        <div class="flex items-center justify-between">
                            <div>
                                <p class="text-gray-500 text-sm">Avg. Session</p>
                                <p id="analyticsAvgSession" class="text-2xl font-bold text-gray-900">0m</p>
                            </div>
                            <i class="fas fa-clock text-purple-500 text-2xl"></i>
                        </div>
                    </div>
                </div>

                <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                    <!-- Top Pages -->
                    <div class="bg-white rounded-xl shadow-sm p-6">
                        <h3 class="text-lg font-semibold text-gray-900 mb-4">Top Pages</h3>
                        <div id="topPagesList" class="space-y-3">
                            <!-- Will be populated by JavaScript -->
                        </div>
                    </div>

                    <!-- Traffic Sources -->
                    <div class="bg-white rounded-xl shadow-sm p-6">
                        <h3 class="text-lg font-semibold text-gray-900 mb-4">Traffic Sources</h3>
                        <div id="trafficSourcesList" class="space-y-3">
                            <!-- Will be populated by JavaScript -->
                        </div>
                    </div>
                </div>
            </div>

            <!-- Carousel Management View -->
            <div id="carouselView" class="page-view hidden">
                <div class="flex justify-between items-center mb-6">
                    <div>
                        <h2 class="text-2xl font-bold text-gray-900">Carousel Management</h2>
                        <p class="text-gray-600">Manage homepage carousel images and content</p>
                    </div>
                    <div class="flex space-x-3">
                        <button id="carouselBulkUpload" class="bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition">
                            <i class="fas fa-upload mr-2"></i>Upload Images
                        </button>
                        <button id="carouselPreview" class="bg-green-600 text-white px-4 py-2 rounded-lg hover:bg-green-700 transition">
                            <i class="fas fa-eye mr-2"></i>Preview
                        </button>
                        <button id="carouselSync" class="bg-purple-600 text-white px-4 py-2 rounded-lg hover:bg-purple-700 transition">
                            <i class="fas fa-sync mr-2"></i>Sync to Homepage
                        </button>
                    </div>
                </div>

                <!-- Carousel Stats -->
                <div class="grid grid-cols-1 md:grid-cols-4 gap-6 mb-6">
                    <div class="bg-white rounded-xl shadow-sm p-6">
                        <div class="flex items-center justify-between">
                            <div>
                                <p class="text-gray-500 text-sm">Total Images</p>
                                <p id="carouselTotalImages" class="text-2xl font-bold text-gray-900">0</p>
                            </div>
                            <i class="fas fa-images text-blue-500 text-2xl"></i>
                        </div>
                    </div>
                    <div class="bg-white rounded-xl shadow-sm p-6">
                        <div class="flex items-center justify-between">
                            <div>
                                <p class="text-gray-500 text-sm">Active</p>
                                <p id="carouselActiveImages" class="text-2xl font-bold text-green-600">0</p>
                            </div>
                            <i class="fas fa-check-circle text-green-500 text-2xl"></i>
                        </div>
                    </div>
                    <div class="bg-white rounded-xl shadow-sm p-6">
                        <div class="flex items-center justify-between">
                            <div>
                                <p class="text-gray-500 text-sm">Storage Used</p>
                                <p id="carouselStorageUsed" class="text-2xl font-bold text-yellow-600">0 MB</p>
                            </div>
                            <i class="fas fa-hdd text-yellow-500 text-2xl"></i>
                        </div>
                    </div>
                    <div class="bg-white rounded-xl shadow-sm p-6">
                        <div class="flex items-center justify-between">
                            <div>
                                <p class="text-gray-500 text-sm">Performance</p>
                                <p id="carouselPerformance" class="text-2xl font-bold text-purple-600">Good</p>
                            </div>
                            <i class="fas fa-tachometer-alt text-purple-500 text-2xl"></i>
                        </div>
                    </div>
                </div>

                <!-- Carousel Items Management -->
                <div class="bg-white rounded-xl shadow-sm p-6 mb-6">
                    <div class="flex justify-between items-center mb-4">
                        <h3 class="text-lg font-semibold text-gray-900">Carousel Items</h3>
                        <div class="flex items-center space-x-2">
                            <span class="text-sm text-gray-500">Drag to reorder</span>
                            <button id="carouselSaveOrder" class="bg-green-600 text-white px-3 py-1 rounded text-sm hover:bg-green-700 transition">
                                <i class="fas fa-save mr-1"></i>Save Order
                            </button>
                        </div>
                    </div>
                    
                    <div id="carouselItemsList" class="space-y-4">
                        <!-- Carousel items will be loaded here -->
                        <div class="text-center py-12 text-gray-500">
                            <i class="fas fa-images text-4xl mb-4"></i>
                            <h3 class="text-xl font-semibold mb-2">No carousel items yet</h3>
                            <p class="mb-6">Start building your carousel by uploading images</p>
                            <button id="carouselAddFirst" class="bg-blue-600 text-white px-6 py-3 rounded-lg hover:bg-blue-700 transition">
                                <i class="fas fa-plus mr-2"></i>Add First Item
                            </button>
                        </div>
                    </div>
                </div>

                <!-- Live Preview -->
                <div class="bg-white rounded-xl shadow-sm p-6">
                    <h3 class="text-lg font-semibold text-gray-900 mb-4">Live Preview</h3>
                    <div id="carouselLivePreview" class="bg-gray-100 rounded-lg p-8 text-center">
                        <p class="text-gray-500">No active items for preview</p>
                    </div>
                    <div class="mt-4 flex justify-center space-x-2">
                        <button id="carouselPreviewPrev" class="bg-gray-600 text-white px-3 py-2 rounded hover:bg-gray-700 transition">
                            <i class="fas fa-chevron-left"></i>
                        </button>
                        <button id="carouselAutoplay" class="bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700 transition">
                            <i class="fas fa-play mr-1"></i>Auto Play
                        </button>
                        <button id="carouselPreviewNext" class="bg-gray-600 text-white px-3 py-2 rounded hover:bg-gray-700 transition">
                            <i class="fas fa-chevron-right"></i>
                        </button>
                    </div>
                </div>
            </div>

            <!-- User Management View -->
            <div id="usersView" class="page-view hidden">
                <div class="flex justify-between items-center mb-6">
                    <h2 class="text-2xl font-bold text-gray-900">User Management</h2>
                    <button id="inviteUserBtn" class="bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700">
                        <i class="fas fa-plus mr-2"></i>Invite User
                    </button>
                </div>

                <div class="bg-white rounded-xl shadow-sm overflow-hidden">
                    <div class="overflow-x-auto">
                        <table class="w-full">
                            <thead class="bg-gray-50">
                                <tr>
                                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">User</th>
                                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Role</th>
                                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Status</th>
                                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Last Login</th>
                                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Actions</th>
                                </tr>
                            </thead>
                            <tbody id="usersList" class="bg-white divide-y divide-gray-200">
                                <!-- Will be populated by JavaScript -->
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>

            <!-- API Keys View -->
            <div id="apiView" class="page-view hidden">
                <div class="flex justify-between items-center mb-6">
                    <h2 class="text-2xl font-bold text-gray-900">API Keys</h2>
                    <button id="generateApiKeyBtn" class="bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700">
                        <i class="fas fa-plus mr-2"></i>Generate API Key
                    </button>
                </div>

                <div class="bg-white rounded-xl shadow-sm p-6">
                    <div id="apiKeysList" class="space-y-4">
                        <!-- Will be populated by JavaScript -->
                    </div>
                </div>
            </div>

            <!-- Backups View -->
            <div id="backupsView" class="page-view hidden">
                <div class="flex justify-between items-center mb-6">
                    <h2 class="text-2xl font-bold text-gray-900">Backup Management</h2>
                    <button id="createBackupBtn" class="bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700">
                        <i class="fas fa-plus mr-2"></i>Create Backup
                    </button>
                </div>

                <div class="grid grid-cols-1 lg:grid-cols-3 gap-6 mb-6">
                    <div class="bg-white rounded-xl shadow-sm p-6">
                        <h3 class="font-semibold text-gray-900 mb-2">Backup Schedule</h3>
                        <div class="space-y-2">
                            <label class="flex items-center">
                                <input type="checkbox" id="dailyBackup" class="mr-2" checked>
                                <span class="text-sm">Daily Backups</span>
                            </label>
                            <label class="flex items-center">
                                <input type="checkbox" id="weeklyBackup" class="mr-2" checked>
                                <span class="text-sm">Weekly Backups</span>
                            </label>
                            <label class="flex items-center">
                                <input type="checkbox" id="monthlyBackup" class="mr-2" checked>
                                <span class="text-sm">Monthly Backups</span>
                            </label>
                        </div>
                    </div>
                    <div class="bg-white rounded-xl shadow-sm p-6">
                        <h3 class="font-semibold text-gray-900 mb-2">Storage Usage</h3>
                        <div class="text-2xl font-bold text-blue-600">2.4 GB</div>
                        <p class="text-sm text-gray-500">of 10 GB used</p>
                    </div>
                    <div class="bg-white rounded-xl shadow-sm p-6">
                        <h3 class="font-semibold text-gray-900 mb-2">Last Backup</h3>
                        <div class="text-sm text-gray-900" id="lastBackupTime">Loading...</div>
                        <p class="text-sm text-gray-500">Automatic backup</p>
                    </div>
                </div>

                <div class="bg-white rounded-xl shadow-sm overflow-hidden">
                    <div class="overflow-x-auto">
                        <table class="w-full">
                            <thead class="bg-gray-50">
                                <tr>
                                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Type</th>
                                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Size</th>
                                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Created</th>
                                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Status</th>
                                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Actions</th>
                                </tr>
                            </thead>
                            <tbody id="backupsList" class="bg-white divide-y divide-gray-200">
                                <!-- Will be populated by JavaScript -->
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>

            <!-- Integrations View -->
            <div id="integrationsView" class="page-view hidden">
                <h2 class="text-2xl font-bold text-gray-900 mb-6">Integrations</h2>
                
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                    <div id="integrationsList">
                        <!-- Will be populated by JavaScript -->
                    </div>
                </div>
            </div>

            <!-- Billing View -->
            <div id="billingView" class="page-view hidden">
                <h2 class="text-2xl font-bold text-gray-900 mb-6">Billing & Subscription</h2>
                
                <div class="grid grid-cols-1 lg:grid-cols-3 gap-6 mb-8">
                    <!-- Current Plan -->
                    <div class="bg-white rounded-xl shadow-sm p-6">
                        <h3 class="font-semibold text-gray-900 mb-4">Current Plan</h3>
                        <div id="currentPlan" class="text-center">
                            <div class="text-2xl font-bold text-blue-600">Professional</div>
                            <div class="text-gray-500">$29/month</div>
                            <div class="mt-4">
                                <button class="bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700">
                                    Manage Plan
                                </button>
                            </div>
                        </div>
                    </div>

                    <!-- Usage -->
                    <div class="bg-white rounded-xl shadow-sm p-6">
                        <h3 class="font-semibold text-gray-900 mb-4">Usage</h3>
                        <div class="space-y-3">
                            <div>
                                <div class="flex justify-between text-sm">
                                    <span>Users</span>
                                    <span>2 / 5</span>
                                </div>
                                <div class="w-full bg-gray-200 rounded-full h-2 mt-1">
                                    <div class="bg-blue-600 h-2 rounded-full" style="width: 40%"></div>
                                </div>
                            </div>
                            <div>
                                <div class="flex justify-between text-sm">
                                    <span>Projects</span>
                                    <span>15 / ∞</span>
                                </div>
                                <div class="w-full bg-gray-200 rounded-full h-2 mt-1">
                                    <div class="bg-green-600 h-2 rounded-full" style="width: 15%"></div>
                                </div>
                            </div>
                            <div>
                                <div class="flex justify-between text-sm">
                                    <span>Storage</span>
                                    <span>2.4GB / 10GB</span>
                                </div>
                                <div class="w-full bg-gray-200 rounded-full h-2 mt-1">
                                    <div class="bg-yellow-600 h-2 rounded-full" style="width: 24%"></div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Next Billing -->
                    <div class="bg-white rounded-xl shadow-sm p-6">
                        <h3 class="font-semibold text-gray-900 mb-4">Next Billing</h3>
                        <div class="text-center">
                            <div class="text-2xl font-bold text-gray-900">$29.00</div>
                            <div class="text-gray-500" id="nextBillingDate">Loading...</div>
                            <div class="mt-4">
                                <button class="text-blue-600 hover:text-blue-700">
                                    View Invoice History
                                </button>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Available Plans -->
                <div class="bg-white rounded-xl shadow-sm p-6">
                    <h3 class="text-lg font-semibold text-gray-900 mb-6">Available Plans</h3>
                    <div class="grid grid-cols-1 md:grid-cols-3 gap-6" id="availablePlans">
                        <!-- Will be populated by JavaScript -->
                    </div>
                </div>
            </div>

            <!-- Support View -->
            <div id="supportView" class="page-view hidden">
                <div class="flex justify-between items-center mb-6">
                    <h2 class="text-2xl font-bold text-gray-900">Support</h2>
                    <button id="createTicketBtn" class="bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700">
                        <i class="fas fa-plus mr-2"></i>Create Ticket
                    </button>
                </div>

                <div class="grid grid-cols-1 lg:grid-cols-3 gap-6 mb-8">
                    <!-- Support Channels -->
                    <div class="bg-white rounded-xl shadow-sm p-6">
                        <h3 class="font-semibold text-gray-900 mb-4">Support Channels</h3>
                        <div class="space-y-3">
                            <div class="flex items-center justify-between">
                                <div class="flex items-center">
                                    <i class="fas fa-comments text-blue-500 mr-2"></i>
                                    <span class="text-sm">Live Chat</span>
                                </div>
                                <span class="text-xs bg-green-100 text-green-800 px-2 py-1 rounded-full">Available</span>
                            </div>
                            <div class="flex items-center justify-between">
                                <div class="flex items-center">
                                    <i class="fas fa-envelope text-blue-500 mr-2"></i>
                                    <span class="text-sm">Email Support</span>
                                </div>
                                <span class="text-xs bg-green-100 text-green-800 px-2 py-1 rounded-full">24/7</span>
                            </div>
                            <div class="flex items-center justify-between">
                                <div class="flex items-center">
                                    <i class="fas fa-phone text-gray-400 mr-2"></i>
                                    <span class="text-sm text-gray-400">Phone Support</span>
                                </div>
                                <span class="text-xs bg-gray-100 text-gray-600 px-2 py-1 rounded-full">Enterprise</span>
                            </div>
                        </div>
                    </div>

                    <!-- Response Times -->
                    <div class="bg-white rounded-xl shadow-sm p-6">
                        <h3 class="font-semibold text-gray-900 mb-4">Response Times</h3>
                        <div class="space-y-3">
                            <div class="flex justify-between">
                                <span class="text-sm">Critical</span>
                                <span class="text-sm font-medium">< 1 hour</span>
                            </div>
                            <div class="flex justify-between">
                                <span class="text-sm">High</span>
                                <span class="text-sm font-medium">< 4 hours</span>
                            </div>
                            <div class="flex justify-between">
                                <span class="text-sm">Medium</span>
                                <span class="text-sm font-medium">< 24 hours</span>
                            </div>
                            <div class="flex justify-between">
                                <span class="text-sm">Low</span>
                                <span class="text-sm font-medium">< 48 hours</span>
                            </div>
                        </div>
                    </div>

                    <!-- Quick Actions -->
                    <div class="bg-white rounded-xl shadow-sm p-6">
                        <h3 class="font-semibold text-gray-900 mb-4">Quick Actions</h3>
                        <div class="space-y-2">
                            <button class="w-full text-left p-2 text-sm hover:bg-gray-50 rounded">
                                <i class="fas fa-book mr-2 text-blue-500"></i>
                                View Documentation
                            </button>
                            <button class="w-full text-left p-2 text-sm hover:bg-gray-50 rounded">
                                <i class="fas fa-video mr-2 text-green-500"></i>
                                Watch Tutorials
                            </button>
                            <button class="w-full text-left p-2 text-sm hover:bg-gray-50 rounded">
                                <i class="fas fa-users mr-2 text-purple-500"></i>
                                Community Forum
                            </button>
                        </div>
                    </div>
                </div>

                <!-- Support Tickets -->
                <div class="bg-white rounded-xl shadow-sm overflow-hidden">
                    <div class="px-6 py-4 border-b">
                        <h3 class="text-lg font-semibold text-gray-900">Your Support Tickets</h3>
                    </div>
                    <div class="overflow-x-auto">
                        <table class="w-full">
                            <thead class="bg-gray-50">
                                <tr>
                                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Subject</th>
                                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Status</th>
                                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Priority</th>
                                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Created</th>
                                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Actions</th>
                                </tr>
                            </thead>
                            <tbody id="supportTicketsList" class="bg-white divide-y divide-gray-200">
                                <!-- Will be populated by JavaScript -->
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>

            <!-- Projects View -->
            <div id="projectsView" class="page-view hidden">
                <div class="flex justify-between items-center mb-6">
                    <h2 class="text-2xl font-bold text-gray-900">Projects Management</h2>
                    <button class="bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition">
                        <i class="fas fa-plus mr-2"></i>New Project
                    </button>
                </div>

                <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
                    <!-- Projects will be loaded here -->
                    <div class="bg-white rounded-xl shadow-sm p-6 text-center">
                        <i class="fas fa-folder-open text-4xl text-gray-400 mb-4"></i>
                        <h3 class="text-lg font-semibold text-gray-900 mb-2">No Projects Yet</h3>
                        <p class="text-gray-600 mb-4">Create your first project to get started</p>
                        <button class="bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition">
                            Create Project
                        </button>
                    </div>
                </div>
            </div>

            <!-- Case Studies View -->
            <div id="case-studiesView" class="page-view hidden">
                <div class="flex justify-between items-center mb-6">
                    <h2 class="text-2xl font-bold text-gray-900">Case Studies Management</h2>
                    <div class="flex space-x-3">
                        <button onclick="window.location.href='case_study_editor_complete.html'" class="bg-green-600 text-white px-4 py-2 rounded-lg hover:bg-green-700 transition">
                            <i class="fas fa-edit mr-2"></i>Open Editor
                        </button>
                        <button class="bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition">
                            <i class="fas fa-plus mr-2"></i>New Case Study
                        </button>
                    </div>
                </div>

                <div class="grid grid-cols-1 lg:grid-cols-2 xl:grid-cols-3 gap-6">
                    <!-- Case studies will be loaded here -->
                    <div class="bg-white rounded-xl shadow-sm p-6 text-center">
                        <i class="fas fa-file-alt text-4xl text-gray-400 mb-4"></i>
                        <h3 class="text-lg font-semibold text-gray-900 mb-2">No Case Studies Yet</h3>
                        <p class="text-gray-600 mb-4">Create your first case study to showcase your work</p>
                        <button onclick="window.location.href='case_study_editor_complete.html'" class="bg-green-600 text-white px-4 py-2 rounded-lg hover:bg-green-700 transition">
                            Open Editor
                        </button>
                    </div>
                </div>
            </div>

            <!-- Content Management View -->
            <div id="contentView" class="page-view hidden">
                <div class="flex justify-between items-center mb-6">
                    <h2 class="text-2xl font-bold text-gray-900">Content Management</h2>
                    <button class="bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition">
                        <i class="fas fa-plus mr-2"></i>Add Content
                    </button>
                </div>

                <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                    <!-- Content Editor Integration -->
                    <div class="bg-white rounded-xl shadow-sm p-6">
                        <h3 class="text-lg font-semibold text-gray-900 mb-4">Case Study Editor</h3>
                        <p class="text-gray-600 mb-4">Create and edit case studies with our integrated editor</p>
                        <div class="flex space-x-3">
                            <button onclick="window.location.href='case_study_editor_complete.html'" class="bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition">
                                <i class="fas fa-magic mr-2"></i>Case Study Editor
                            </button>
                        </div>
                    </div>

                    <!-- Image Management -->
                    <div class="bg-white rounded-xl shadow-sm p-6">
                        <h3 class="text-lg font-semibold text-gray-900 mb-4">Image Management</h3>
                        <p class="text-gray-600 mb-4">Manage and resize images for your content</p>
                        <div class="flex space-x-3">
                            <button onclick="window.open('image-resizer-demo.html', '_blank')" class="bg-purple-600 text-white px-4 py-2 rounded-lg hover:bg-purple-700 transition">
                                <i class="fas fa-image mr-2"></i>Image Resizer
                            </button>
                            <button onclick="this.switchView('carousel')" class="bg-indigo-600 text-white px-4 py-2 rounded-lg hover:bg-indigo-700 transition">
                                <i class="fas fa-images mr-2"></i>Carousel
                            </button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Settings View -->
            <div id="settingsView" class="page-view hidden">
                <div class="flex justify-between items-center mb-6">
                    <h2 class="text-2xl font-bold text-gray-900">Settings</h2>
                </div>

                <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                    <!-- System Settings -->
                    <div class="bg-white rounded-xl shadow-sm p-6">
                        <h3 class="text-lg font-semibold text-gray-900 mb-4">System Settings</h3>
                        <div class="space-y-4">
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">Site Title</label>
                                <input type="text" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent" value="Portfolio Admin">
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">Site Description</label>
                                <textarea class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent" rows="3">Professional portfolio management system</textarea>
                            </div>
                        </div>
                    </div>

                    <!-- Integration Settings -->
                    <div class="bg-white rounded-xl shadow-sm p-6">
                        <h3 class="text-lg font-semibold text-gray-900 mb-4">Integration Settings</h3>
                        <div class="space-y-4">
                            <div class="flex items-center justify-between p-3 bg-green-50 rounded-lg">
                                <div>
                                    <h4 class="font-medium text-green-900">Cloudinary</h4>
                                    <p class="text-sm text-green-700">Image upload and processing</p>
                                </div>
                                <span class="px-2 py-1 bg-green-100 text-green-800 text-xs rounded-full">Connected</span>
                            </div>
                            <div class="flex items-center justify-between p-3 bg-blue-50 rounded-lg">
                                <div>
                                    <h4 class="font-medium text-blue-900">Supabase</h4>
                                    <p class="text-sm text-blue-700">Database and authentication</p>
                                </div>
                                <span class="px-2 py-1 bg-blue-100 text-blue-800 text-xs rounded-full">Connected</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Carousel View -->
            <div id="carouselView" class="page-view hidden">
                <div class="flex justify-between items-center mb-6">
                    <h2 class="text-2xl font-bold text-gray-900">Carousel Management</h2>
                    <button onclick="openCarouselUpload()" class="bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition">
                        <i class="fas fa-plus mr-2"></i>Add Images
                    </button>
                </div>

                <!-- Upload Section -->
                <div class="bg-white rounded-xl shadow-sm p-6 mb-6">
                    <h3 class="text-lg font-semibold text-gray-900 mb-4">Upload New Images</h3>
                    
                    <!-- Drop Zone -->
                    <div id="carouselDropZone" class="border-2 border-dashed border-gray-300 rounded-lg p-8 text-center transition-colors hover:border-blue-500 cursor-pointer"
                         onclick="openCarouselUpload()">
                        <i class="fas fa-cloud-upload-alt text-4xl text-gray-400 mb-4"></i>
                        <h4 class="text-lg font-semibold text-gray-900 mb-2">Drop Images Here</h4>
                        <p class="text-gray-600 mb-4">Or click to select files</p>
                        <p class="text-sm text-gray-500">Supports JPG, PNG, WebP. Max 10MB per image</p>
                    </div>
                </div>

                <!-- Carousel Preview -->
                <div class="bg-white rounded-xl shadow-sm p-6 mb-6">
                    <h3 class="text-lg font-semibold text-gray-900 mb-4">Carousel Preview</h3>
                    <div id="carouselPreviewContainer" class="bg-gray-100 rounded-lg overflow-hidden">
                        <div id="carouselPreview" class="relative h-64">
                            <!-- Carousel preview will be rendered here -->
                            <div class="flex items-center justify-center h-full text-gray-500">
                                <div class="text-center">
                                    <i class="fas fa-images text-4xl mb-4"></i>
                                    <p>No images in carousel yet</p>
                                    <p class="text-sm">Upload some images to see the preview</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Image Management Grid -->
                <div class="bg-white rounded-xl shadow-sm p-6">
                    <h3 class="text-lg font-semibold text-gray-900 mb-4">Manage Images</h3>
                    <div id="carouselImageGrid" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-4">
                        <!-- Images will be rendered here -->
                        <div class="col-span-full text-center py-12 text-gray-500">
                            <i class="fas fa-images text-4xl mb-4"></i>
                            <p>No images uploaded yet</p>
                            <p class="text-sm">Upload your first carousel image to get started</p>
                        </div>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <!-- Notification Panel -->
    <div id="notificationPanel" class="fixed top-16 right-4 w-80 bg-white rounded-lg shadow-lg border hidden z-50">
        <div class="p-4 border-b">
            <h3 class="font-semibold text-gray-900">Notifications</h3>
        </div>
        <div id="notificationList" class="max-h-96 overflow-y-auto">
            <!-- Notifications will be loaded here -->
        </div>
    </div>

    <!-- Load Supabase -->
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    
    <!-- Load Authentication System -->
    <script src="js/supabase-client.js"></script>
    <script src="js/auth-system.js"></script>
    <script src="js/saas-features.js"></script>
    
    <script>
        class AdminDashboard {
            constructor() {
                this.currentView = 'dashboard';
                this.init();
            }

            async init() {
                // Check authentication - BYPASSED FOR TESTING
                const token = localStorage.getItem('portfolio_auth_token');
                const userData = localStorage.getItem('portfolio_user_data');
                
                // BYPASS AUTH FOR TESTING - Set mock data
                if (!token || !userData) {
                    console.log('No authentication found, setting mock data for testing');
                    localStorage.setItem('portfolio_auth_token', 'mock_token_for_testing');
                    localStorage.setItem('portfolio_user_data', JSON.stringify({
                        name: 'Test Admin',
                        email: 'admin@test.com',
                        role: 'admin'
                    }));
                }

                console.log('Authentication found, initializing dashboard');
                this.setupEventListeners();
                this.loadUserData();
                this.loadDashboardData();
                this.setupNavigation();
            }

            setupEventListeners() {
                // Sidebar toggle
                document.getElementById('sidebarToggle').addEventListener('click', () => {
                    this.toggleSidebar();
                });

                // User menu
                document.getElementById('userMenuBtn').addEventListener('click', () => {
                    this.toggleUserMenu();
                });

                // Logout
                document.getElementById('logoutBtn').addEventListener('click', () => {
                    this.logout();
                });

                // Notifications
                document.getElementById('notificationBtn').addEventListener('click', () => {
                    this.toggleNotifications();
                });

                // Navigation items
                document.querySelectorAll('.nav-item').forEach(item => {
                    item.addEventListener('click', (e) => {
                        e.preventDefault();
                        const view = item.getAttribute('href').substring(1);
                        this.switchView(view);
                    });
                });

                // Quick actions
                document.querySelectorAll('.quick-action-btn').forEach(btn => {
                    btn.addEventListener('click', () => {
                        const action = btn.querySelector('span').textContent;
                        this.handleQuickAction(action);
                    });
                });

                // Forms
                document.getElementById('profileForm').addEventListener('submit', (e) => {
                    e.preventDefault();
                    this.updateProfile();
                });

                document.getElementById('passwordForm').addEventListener('submit', (e) => {
                    e.preventDefault();
                    this.changePassword();
                });

                // Close dropdowns when clicking outside
                document.addEventListener('click', (e) => {
                    if (!e.target.closest('#userMenuBtn')) {
                        document.getElementById('userDropdown').classList.add('hidden');
                    }
                    if (!e.target.closest('#notificationBtn')) {
                        document.getElementById('notificationPanel').classList.add('hidden');
                    }
                });
            }

            async loadUserData() {
                const user = window.authSystem.getCurrentUser();
                if (user) {
                    document.getElementById('userName').textContent = user.name || user.email;
                    document.getElementById('profileName').value = user.name || '';
                    document.getElementById('profileEmail').value = user.email || '';
                    
                    if (user.avatar) {
                        document.getElementById('userAvatar').src = user.avatar;
                        document.getElementById('profileAvatar').src = user.avatar;
                    }
                }
            }

            async loadDashboardData() {
                try {
                    // Load metrics
                    const [projects, caseStudies, carouselImages] = await Promise.all([
                        this.fetchData('/api/projects'),
                        this.fetchData('/api/case-studies'),
                        this.fetchData('/api/carousel-images')
                    ]);

                    document.getElementById('totalProjects').textContent = projects.length || 0;
                    document.getElementById('totalCaseStudies').textContent = caseStudies.length || 0;
                    document.getElementById('totalCarouselImages').textContent = carouselImages.length || 0;
                    document.getElementById('totalPageViews').textContent = '1,234'; // Mock data

                    // Load recent activity
                    this.loadRecentActivity();

                    // Initialize SaaS features
                    this.initializeSaaSFeatures();

                } catch (error) {
                    console.error('Error loading dashboard data:', error);
                }
            }

            // ==================== SAAS FEATURES INITIALIZATION ====================

            async initializeSaaSFeatures() {
                // Wait for SaaS features to be available
                if (typeof window.saasFeatures === 'undefined') {
                    setTimeout(() => this.initializeSaaSFeatures(), 100);
                    return;
                }

                // Setup SaaS feature event listeners
                this.setupSaaSEventListeners();
                
                // Load initial data for all views
                this.loadAnalyticsData();
                this.loadUsersData();
                this.loadAPIKeysData();
                this.loadBackupsData();
                this.loadIntegrationsData();
                this.loadBillingData();
                this.loadSupportData();
            }

            setupSaaSEventListeners() {
                // Analytics events
                document.getElementById('analyticsView')?.addEventListener('click', () => {
                    this.loadAnalyticsData();
                });

                // User management events
                document.getElementById('usersView')?.addEventListener('click', () => {
                    this.loadUsersData();
                });
            }

            async fetchData(endpoint) {
                try {
                    // Use standardized API consolidator for consistent requests
                    if (window.apiConsolidator) {
                        const result = await window.apiConsolidator.makeRequest(endpoint);
                        return result.success ? result.data : [];
                    }
                    
                    // Fallback to direct fetch if consolidator not available
                    const token = window.authSystem.getToken();
                    const response = await fetch(endpoint, {
                        headers: token ? { 'Authorization': `Bearer ${token}` } : {}
                    });
                    
                    if (response.ok) {
                        return await response.json();
                    }
                    return [];
                } catch (error) {
                    console.error(`Error fetching ${endpoint} via standardized method:`, error);
                    return [];
                }
            }

            loadRecentActivity() {
                const activities = [
                    { type: 'project', message: 'New project "E-commerce Platform" created', time: '2 hours ago', color: 'blue' },
                    { type: 'image', message: 'Carousel image uploaded', time: '4 hours ago', color: 'green' },
                    { type: 'case-study', message: 'Case study "Mobile App Design" updated', time: '1 day ago', color: 'purple' },
                    { type: 'security', message: 'Password changed successfully', time: '2 days ago', color: 'yellow' }
                ];

                const container = document.getElementById('recentActivity');
                container.innerHTML = activities.map(activity => `
                    <div class="flex items-center space-x-3 activity-item p-2 rounded">
                        <div class="w-2 h-2 bg-${activity.color}-500 rounded-full"></div>
                        <div class="flex-1">
                            <p class="text-sm text-gray-900">${activity.message}</p>
                            <p class="text-xs text-gray-500">${activity.time}</p>
                        </div>
                    </div>
                `).join('');
            }

            setupNavigation() {
                // Handle hash fragment in URL (e.g., #carousel)
                this.handleHashFragment();
                
                // Set active nav item
                this.updateActiveNav(this.currentView || 'dashboard');
            }

            handleHashFragment() {
                const hash = window.location.hash.substring(1); // Remove #
                if (hash && hash !== 'dashboard') {
                    console.log(`Handling hash fragment: ${hash}`);
                    this.switchView(hash);
                } else {
                    this.currentView = 'dashboard';
                }
                
                // Listen for hash changes
                window.addEventListener('hashchange', () => {
                    const newHash = window.location.hash.substring(1);
                    if (newHash) {
                        this.switchView(newHash);
                    }
                });
            }

            switchView(view) {
                // Hide all views
                document.querySelectorAll('.page-view').forEach(v => v.classList.add('hidden'));
                
                // Show selected view
                const viewElement = document.getElementById(`${view}View`);
                if (viewElement) {
                    viewElement.classList.remove('hidden');
                    this.currentView = view;
                    
                    // Update page title
                    const titles = {
                        'dashboard': 'Dashboard',
                        'security': 'Security',
                        'profile': 'Profile',
                        'projects': 'Projects',
                        'case-studies': 'Case Studies',
                        'carousel': 'Carousel',
                        'content': 'Content',
                        'analytics': 'Analytics',
                        'users': 'User Management',
                        'api': 'API Keys',
                        'backups': 'Backups',
                        'integrations': 'Integrations',
                        'billing': 'Billing',
                        'support': 'Support',
                        'settings': 'Settings'
                    };
                    
                    document.getElementById('pageTitle').textContent = titles[view] || 'Dashboard';
                    this.updateActiveNav(view);
                    
                    // Load view-specific data
                    this.loadViewData(view);
                }
            }

            async loadViewData(view) {
                switch (view) {
                    case 'dashboard':
                        await this.loadDashboardData();
                        break;
                    case 'security':
                        await this.loadSecurityData();
                        break;
                    case 'carousel':
                        await this.loadCarouselData();
                        break;
                    case 'profile':
                        await this.loadProfileData();
                        break;
                    case 'projects':
                        await this.loadProjectsData();
                        break;
                    case 'case-studies':
                        await this.loadCaseStudiesData();
                        break;
                    case 'content':
                        await this.loadContentData();
                        break;
                    case 'analytics':
                        await this.loadAnalyticsData();
                        break;
                    case 'users':
                        await this.loadUsersData();
                        break;
                    case 'settings':
                        await this.loadSettingsData();
                        break;
                }
            }

            async loadSecurityData() {
                try {
                    const [sessions, logs] = await Promise.all([
                        window.authSystem.getActiveSessions(),
                        window.authSystem.getSecurityLogs()
                    ]);

                    this.renderActiveSessions(sessions);
                    this.renderSecurityLogs(logs);
                } catch (error) {
                    console.error('Error loading security data:', error);
                }
            }

            renderActiveSessions(sessions) {
                const container = document.getElementById('activeSessions');
                
                if (!sessions.length) {
                    container.innerHTML = '<p class="text-gray-500 text-sm">No active sessions</p>';
                    return;
                }

                container.innerHTML = sessions.map(session => `
                    <div class="flex items-center justify-between p-3 bg-gray-50 rounded-lg">
                        <div class="flex items-center space-x-3">
                            <i class="fas fa-desktop text-gray-600"></i>
                            <div>
                                <p class="text-sm font-medium">${session.device || 'Unknown Device'}</p>
                                <p class="text-xs text-gray-500">${session.location || 'Unknown Location'}</p>
                            </div>
                        </div>
                        <div class="flex items-center space-x-2">
                            <span class="text-xs ${session.current ? 'text-green-600' : 'text-gray-500'}">
                                ${session.current ? 'Current' : 'Active'}
                            </span>
                            ${!session.current ? `
                                <button class="text-red-600 hover:text-red-800 text-xs">
                                    <i class="fas fa-times"></i>
                                </button>
                            ` : ''}
                        </div>
                    </div>
                `).join('');
            }

            renderSecurityLogs(logs) {
                const container = document.getElementById('securityLogs');
                
                if (!logs.length) {
                    container.innerHTML = '<p class="text-gray-500 text-sm">No security logs</p>';
                    return;
                }

                container.innerHTML = logs.slice(0, 10).map(log => `
                    <div class="flex items-center justify-between py-2 border-b border-gray-100 last:border-b-0">
                        <div class="flex items-center space-x-3">
                            <i class="fas fa-${this.getLogIcon(log.event)} text-gray-600"></i>
                            <div>
                                <p class="text-sm">${this.getLogMessage(log)}</p>
                                <p class="text-xs text-gray-500">${new Date(log.timestamp).toLocaleString()}</p>
                            </div>
                        </div>
                        <span class="text-xs px-2 py-1 rounded-full ${this.getLogBadgeClass(log.event)}">
                            ${log.event.replace('_', ' ')}
                        </span>
                    </div>
                `).join('');
            }

            getLogIcon(event) {
                const icons = {
                    'login_success': 'sign-in-alt',
                    'login_failed': 'exclamation-triangle',
                    'logout': 'sign-out-alt',
                    'password_changed': 'key',
                    'session_timeout': 'clock',
                    'device_change': 'mobile-alt',
                    'location_change': 'map-marker-alt'
                };
                return icons[event] || 'info-circle';
            }

            getLogMessage(log) {
                const messages = {
                    'login_success': 'Successful login',
                    'login_failed': 'Failed login attempt',
                    'logout': 'User logged out',
                    'password_changed': 'Password changed',
                    'session_timeout': 'Session expired',
                    'device_change': 'New device detected',
                    'location_change': 'Location change detected'
                };
                return messages[log.event] || log.event;
            }

            getLogBadgeClass(event) {
                const classes = {
                    'login_success': 'bg-green-100 text-green-800',
                    'login_failed': 'bg-red-100 text-red-800',
                    'logout': 'bg-blue-100 text-blue-800',
                    'password_changed': 'bg-yellow-100 text-yellow-800',
                    'session_timeout': 'bg-gray-100 text-gray-800',
                    'device_change': 'bg-purple-100 text-purple-800',
                    'location_change': 'bg-orange-100 text-orange-800'
                };
                return classes[event] || 'bg-gray-100 text-gray-800';
            }

            updateActiveNav(view) {
                document.querySelectorAll('.nav-item').forEach(item => {
                    item.classList.remove('active', 'bg-blue-100', 'text-blue-600');
                });
                
                const activeItem = document.querySelector(`[href="#${view}"]`);
                if (activeItem) {
                    activeItem.classList.add('active', 'bg-blue-100', 'text-blue-600');
                }
            }

            toggleSidebar() {
                const sidebar = document.getElementById('sidebar');
                sidebar.classList.toggle('-translate-x-full');
            }

            toggleUserMenu() {
                const dropdown = document.getElementById('userDropdown');
                dropdown.classList.toggle('hidden');
            }

            toggleNotifications() {
                const panel = document.getElementById('notificationPanel');
                panel.classList.toggle('hidden');
                
                if (!panel.classList.contains('hidden')) {
                    this.loadNotifications();
                }
            }

            loadNotifications() {
                const notifications = [
                    { type: 'info', message: 'New project created successfully', time: '5 min ago' },
                    { type: 'warning', message: 'Carousel image needs optimization', time: '1 hour ago' },
                    { type: 'success', message: 'Case study published', time: '2 hours ago' }
                ];

                const container = document.getElementById('notificationList');
                container.innerHTML = notifications.map(notif => `
                    <div class="p-4 border-b hover:bg-gray-50">
                        <div class="flex items-start space-x-3">
                            <i class="fas fa-${notif.type === 'info' ? 'info-circle text-blue-500' : 
                                                notif.type === 'warning' ? 'exclamation-triangle text-yellow-500' : 
                                                'check-circle text-green-500'} mt-1"></i>
                            <div class="flex-1">
                                <p class="text-sm text-gray-900">${notif.message}</p>
                                <p class="text-xs text-gray-500 mt-1">${notif.time}</p>
                            </div>
                        </div>
                    </div>
                `).join('');
            }

            showNotification(message, type = 'info') {
                // Create a temporary notification
                const notification = document.createElement('div');
                notification.className = `fixed top-4 right-4 z-50 p-4 rounded-lg shadow-lg max-w-sm ${
                    type === 'success' ? 'bg-green-500 text-white' :
                    type === 'error' ? 'bg-red-500 text-white' :
                    type === 'warning' ? 'bg-yellow-500 text-white' :
                    'bg-blue-500 text-white'
                }`;
                notification.innerHTML = `
                    <div class="flex items-center justify-between">
                        <span>${message}</span>
                        <button onclick="this.remove()" class="ml-4 text-white hover:text-gray-200">
                            <i class="fas fa-times"></i>
                        </button>
                    </div>
                `;
                
                document.body.appendChild(notification);
                
                // Auto-remove after 5 seconds
                setTimeout(() => {
                    if (notification.parentNode) {
                        notification.remove();
                    }
                }, 5000);
            }

            handleQuickAction(action) {
                const actions = {
                    'New Project': () => this.switchView('projects'),
                    'New Case Study': () => this.switchView('case-studies'),
                    'Add Image': () => this.switchView('carousel'),
                    'Edit Content': () => this.switchView('content')
                };

                if (actions[action]) {
                    actions[action]();
                }
            }

            async updateProfile() {
                const name = document.getElementById('profileName').value;
                const email = document.getElementById('profileEmail').value;

                try {
                    await window.authSystem.updateProfile({ name, email });
                    this.showAlert('success', 'Profile updated successfully');
                } catch (error) {
                    this.showAlert('error', error.message);
                }
            }

            async changePassword() {
                const currentPassword = document.getElementById('currentPassword').value;
                const newPassword = document.getElementById('newPassword').value;
                const confirmPassword = document.getElementById('confirmNewPassword').value;

                if (newPassword !== confirmPassword) {
                    this.showAlert('error', 'New passwords do not match');
                    return;
                }

                try {
                    await window.authSystem.changePassword(currentPassword, newPassword);
                    this.showAlert('success', 'Password changed successfully');
                    
                    // Clear form
                    document.getElementById('passwordForm').reset();
                } catch (error) {
                    this.showAlert('error', error.message);
                }
            }

            async logout() {
                try {
                    await window.authSystem.logout();
                } catch (error) {
                    console.error('Logout error:', error);
                    // Force redirect even if logout fails
                    window.location.href = '/admin-login-v2.html';
                }
            }

            // Carousel Management Functions
            async loadProjectsData() {
                try {
                    const projects = await this.fetchData('/api/projects');
                    console.log('Projects loaded:', projects.length);
                } catch (error) {
                    console.error('Failed to load projects:', error);
                }
            }

            async loadCaseStudiesData() {
                try {
                    // Use standardized hooks for case studies
                    if (window.standardizedHooks) {
                        const fetchHook = window.standardizedHooks.useFetchCaseStudies();
                        const result = await fetchHook.execute();
                        
                        if (result.success) {
                            console.log('Case studies loaded via standardized hook:', result.data.length);
                            this.renderCaseStudies(result.data);
                            return;
                        }
                    }
                    
                    // Fallback to fetchData method
                    const caseStudies = await this.fetchData('/api/case-studies');
                    console.log('Case studies loaded via fallback:', caseStudies.length);
                    this.renderCaseStudies(caseStudies);
                } catch (error) {
                    console.error('Failed to load case studies via standardized method:', error);
                    this.renderCaseStudies([]);
                }
            }

            renderCaseStudies(caseStudies) {
                const container = document.querySelector('#case-studiesView .grid');
                if (!container) return;

                if (!caseStudies || caseStudies.length === 0) {
                    container.innerHTML = `
                        <div class="bg-white rounded-xl shadow-sm p-6 text-center">
                            <i class="fas fa-file-alt text-4xl text-gray-400 mb-4"></i>
                            <h3 class="text-lg font-semibold text-gray-900 mb-2">No Case Studies Yet</h3>
                            <p class="text-gray-600 mb-4">Create your first case study to showcase your work</p>
                            <button onclick="window.location.href='case_study_editor_complete.html'" class="bg-green-600 text-white px-4 py-2 rounded-lg hover:bg-green-700 transition">
                                Open Editor
                            </button>
                        </div>
                    `;
                    return;
                }

                const caseStudyCards = caseStudies.map(study => `
                    <div class="bg-white rounded-xl shadow-sm p-6 card-hover">
                        <div class="flex items-start justify-between mb-4">
                            <div class="flex-1">
                                <h3 class="text-lg font-semibold text-gray-900 mb-2">${study.project_title || 'Untitled'}</h3>
                                <p class="text-gray-600 text-sm mb-3">${(study.project_description || '').substring(0, 100)}${(study.project_description || '').length > 100 ? '...' : ''}</p>
                                <div class="flex items-center space-x-4 text-sm text-gray-500">
                                    <span class="flex items-center">
                                        <i class="fas fa-calendar mr-1"></i>
                                        ${new Date(study.created_at).toLocaleDateString()}
                                    </span>
                                    <span class="flex items-center">
                                        <i class="fas fa-tag mr-1"></i>
                                        ${study.project_category || 'General'}
                                    </span>
                                    <span class="flex items-center">
                                        <i class="fas fa-circle mr-1 ${study.status === 'published' ? 'text-green-500' : 'text-yellow-500'}"></i>
                                        ${study.status || 'Draft'}
                                    </span>
                                </div>
                            </div>
                            ${study.project_image_url ? `
                                <img src="${study.project_image_url}" alt="${study.project_title}" 
                                     class="w-16 h-16 rounded-lg object-cover ml-4">
                            ` : ''}
                        </div>
                        <div class="flex items-center justify-between pt-4 border-t border-gray-100">
                            <div class="flex space-x-2">
                                <button onclick="window.adminDashboard.editCaseStudy('${study.id}')" class="text-blue-600 hover:text-blue-800 text-sm">
                                    <i class="fas fa-edit mr-1"></i>Edit
                                </button>
                                <button onclick="window.adminDashboard.viewCaseStudy('${study.id}')" class="text-green-600 hover:text-green-800 text-sm">
                                    <i class="fas fa-eye mr-1"></i>View
                                </button>
                                <button onclick="window.adminDashboard.deleteCaseStudy('${study.id}')" class="text-red-600 hover:text-red-800 text-sm">
                                    <i class="fas fa-trash mr-1"></i>Delete
                                </button>
                            </div>
                            <div class="text-xs text-gray-400">
                                ID: ${study.id.substring(0, 8)}...
                            </div>
                        </div>
                    </div>
                `).join('');

                container.innerHTML = caseStudyCards;
            }

            editCaseStudy(id) {
                // For now, just open the editor - could be enhanced to load specific case study
                window.location.href = `case_study_editor_complete.html?id=${id}`;
            }

            viewCaseStudy(id) {
                // Open case study in new tab
                window.open(`/case_study_display.html?id=${id}`, '_blank');
            }

            async deleteCaseStudy(id) {
                if (!confirm('Are you sure you want to delete this case study?')) return;
                
                try {
                    // Use standardized delete hook
                    const deleteHook = window.standardizedHooks.useDeleteCaseStudy();
                    const result = await deleteHook.execute(id, true); // true for confirmation
                    
                    if (result.success) {
                        this.showNotification('Case study deleted successfully', 'success');
                        this.loadCaseStudiesData(); // Reload the list
                        
                        // Trigger homepage sync
                        if (window.CaseStudyHomepageSync) {
                            window.CaseStudyHomepageSync.triggerSync();
                        }
                    } else {
                        throw new Error(result.error?.message || 'Failed to delete case study');
                    }
                } catch (error) {
                    console.error('Delete error via standardized hook:', error);
                    this.showNotification('Failed to delete case study', 'error');
                }
            }

            async loadContentData() {
                console.log('Content management view loaded');
            }

            async loadSettingsData() {
                console.log('Settings view loaded');
            }

            async loadCarouselData() {
                try {
                    // Load carousel images
                    const images = await this.fetchData('/api/carousel/images');
                    this.carouselImages = images || [];
                    this.renderCarouselImages();
                    this.renderCarouselPreview();
                } catch (error) {
                    console.error('Failed to load carousel data:', error);
                    // Load sample data for demo
                    this.carouselImages = [
                        {
                            id: 'sample1',
                            url: 'https://images.unsplash.com/photo-1460925895917-afdab827c52f?w=800&h=400&fit=crop',
                            title: 'Sample Carousel Image 1',
                            description: 'Beautiful landscape showcase'
                        },
                        {
                            id: 'sample2',
                            url: 'https://images.unsplash.com/photo-1551288049-bebda4e38f71?w=800&h=400&fit=crop',
                            title: 'Sample Carousel Image 2',
                            description: 'Modern technology display'
                        }
                    ];
                    this.renderCarouselImages();
                    this.renderCarouselPreview();
                }
            }

            renderCarouselImages() {
                const grid = document.getElementById('carouselImageGrid');
                if (!grid) return;

                if (this.carouselImages.length === 0) {
                    grid.innerHTML = `
                        <div class="col-span-full text-center py-12 text-gray-500">
                            <i class="fas fa-images text-4xl mb-4"></i>
                            <p>No images uploaded yet</p>
                            <p class="text-sm">Upload your first carousel image to get started</p>
                        </div>
                    `;
                    return;
                }

                grid.innerHTML = this.carouselImages.map((image, index) => `
                    <div class="relative group bg-white rounded-lg shadow-md overflow-hidden">
                        <img src="${image.url}" alt="${image.title}" class="w-full h-32 object-cover">
                        
                        <div class="absolute inset-0 bg-black bg-opacity-0 group-hover:bg-opacity-50 transition-all duration-300 flex items-center justify-center">
                            <div class="opacity-0 group-hover:opacity-100 transition-opacity duration-300 flex space-x-2">
                                <button onclick="dashboard.editCarouselImage(${index})" 
                                        class="bg-white text-gray-900 rounded-full w-8 h-8 flex items-center justify-center hover:bg-gray-100 transition">
                                    <i class="fas fa-edit text-sm"></i>
                                </button>
                                <button onclick="dashboard.removeCarouselImage(${index})" 
                                        class="bg-red-500 text-white rounded-full w-8 h-8 flex items-center justify-center hover:bg-red-600 transition">
                                    <i class="fas fa-trash text-sm"></i>
                                </button>
                            </div>
                        </div>

                        <div class="p-3">
                            <h4 class="font-medium text-gray-900 text-sm truncate">${image.title}</h4>
                            <p class="text-xs text-gray-500 mt-1">${image.description || 'No description'}</p>
                        </div>
                    </div>
                `).join('');
            }

            renderCarouselPreview() {
                const preview = document.getElementById('carouselPreview');
                if (!preview) return;

                if (this.carouselImages.length === 0) {
                    preview.innerHTML = `
                        <div class="flex items-center justify-center h-full text-gray-500">
                            <div class="text-center">
                                <i class="fas fa-images text-4xl mb-4"></i>
                                <p>No images in carousel yet</p>
                                <p class="text-sm">Upload some images to see the preview</p>
                            </div>
                        </div>
                    `;
                    return;
                }

                const currentIndex = this.carouselCurrentIndex || 0;
                const currentImage = this.carouselImages[currentIndex];

                preview.innerHTML = `
                    <div class="relative h-full">
                        <img src="${currentImage.url}" alt="${currentImage.title}" class="w-full h-full object-cover">
                        
                        <div class="absolute bottom-0 left-0 right-0 bg-gradient-to-t from-black to-transparent p-4">
                            <h3 class="text-white text-lg font-semibold">${currentImage.title}</h3>
                            <p class="text-white text-sm opacity-90">${currentImage.description}</p>
                        </div>

                        ${this.carouselImages.length > 1 ? `
                            <button onclick="dashboard.previousCarouselSlide()" 
                                    class="absolute left-4 top-1/2 transform -translate-y-1/2 bg-black bg-opacity-50 text-white rounded-full w-10 h-10 flex items-center justify-center hover:bg-opacity-75 transition">
                                <i class="fas fa-chevron-left"></i>
                            </button>
                            <button onclick="dashboard.nextCarouselSlide()" 
                                    class="absolute right-4 top-1/2 transform -translate-y-1/2 bg-black bg-opacity-50 text-white rounded-full w-10 h-10 flex items-center justify-center hover:bg-opacity-75 transition">
                                <i class="fas fa-chevron-right"></i>
                            </button>
                            
                            <div class="absolute bottom-4 left-1/2 transform -translate-x-1/2 flex space-x-2">
                                ${this.carouselImages.map((_, index) => `
                                    <button onclick="dashboard.goToCarouselSlide(${index})" 
                                            class="w-3 h-3 rounded-full transition ${index === currentIndex ? 'bg-white' : 'bg-white bg-opacity-50'}"></button>
                                `).join('')}
                            </div>
                        ` : ''}
                    </div>
                `;
            }

            nextCarouselSlide() {
                this.carouselCurrentIndex = ((this.carouselCurrentIndex || 0) + 1) % this.carouselImages.length;
                this.renderCarouselPreview();
            }

            previousCarouselSlide() {
                this.carouselCurrentIndex = (this.carouselCurrentIndex || 0) === 0 ? 
                    this.carouselImages.length - 1 : (this.carouselCurrentIndex || 0) - 1;
                this.renderCarouselPreview();
            }

            goToCarouselSlide(index) {
                this.carouselCurrentIndex = index;
                this.renderCarouselPreview();
            }

            editCarouselImage(index) {
                const image = this.carouselImages[index];
                const newTitle = prompt('Enter new title:', image.title);
                if (newTitle && newTitle !== image.title) {
                    image.title = newTitle;
                    this.renderCarouselImages();
                    this.renderCarouselPreview();
                    this.showAlert('success', 'Image title updated');
                }
            }

            removeCarouselImage(index) {
                if (confirm('Are you sure you want to remove this image from the carousel?')) {
                    this.carouselImages.splice(index, 1);
                    if (this.carouselCurrentIndex >= this.carouselImages.length) {
                        this.carouselCurrentIndex = Math.max(0, this.carouselImages.length - 1);
                    }
                    this.renderCarouselImages();
                    this.renderCarouselPreview();
                    this.showAlert('success', 'Image removed from carousel');
                }
            }

            showAlert(type, message) {
                // Create alert element
                const alert = document.createElement('div');
                alert.className = `fixed top-4 right-4 z-50 p-4 rounded-lg shadow-lg ${
                    type === 'success' ? 'bg-green-500' : 
                    type === 'error' ? 'bg-red-500' : 'bg-blue-500'
                } text-white transform translate-x-full transition-transform duration-300`;
                
                alert.innerHTML = `
                    <div class="flex items-center space-x-2">
                        <i class="fas fa-${type === 'success' ? 'check' : type === 'error' ? 'exclamation' : 'info'}-circle"></i>
                        <span>${message}</span>
                    </div>
                `;

                document.body.appendChild(alert);

                // Slide in
                setTimeout(() => alert.classList.remove('translate-x-full'), 100);

                // Auto remove
                setTimeout(() => {
                    alert.classList.add('translate-x-full');
                    setTimeout(() => alert.remove(), 300);
                }, 5000);
            }
        }

        // Global variable to access dashboard instance
        let dashboard;

        // Initialize dashboard when DOM is loaded
        document.addEventListener('DOMContentLoaded', () => {
            window.adminDashboard = new AdminDashboard();
        });

        // Global carousel functions
        function openCarouselUpload() {
            const input = document.createElement('input');
            input.type = 'file';
            input.accept = 'image/*';
            input.multiple = true;
            input.onchange = (e) => {
                const files = Array.from(e.target.files);
                handleCarouselFiles(files);
            };
            input.click();
        }

        async function handleCarouselFiles(files) {
            for (const file of files) {
                const imageData = await processCarouselFile(file);
                dashboard.carouselImages = dashboard.carouselImages || [];
                dashboard.carouselImages.push(imageData);
            }
            dashboard.renderCarouselImages();
            dashboard.renderCarouselPreview();
            dashboard.showAlert('success', `${files.length} image(s) added to carousel`);
        }

        async function processCarouselFile(file) {
            return new Promise((resolve) => {
                const reader = new FileReader();
                reader.onload = (e) => {
                    resolve({
                        id: Date.now() + Math.random(),
                        url: e.target.result,
                        title: file.name.replace(/\.[^/.]+$/, ""),
                        description: 'Uploaded carousel image',
                        file: file
                    });
                };
                reader.readAsDataURL(file);
            });
        }

        // Setup drag and drop for carousel
        document.addEventListener('DOMContentLoaded', () => {
            const dropZone = document.getElementById('carouselDropZone');
            if (dropZone) {
                dropZone.addEventListener('dragover', (e) => {
                    e.preventDefault();
                    dropZone.classList.add('border-blue-500', 'bg-blue-50');
                });

                dropZone.addEventListener('dragleave', (e) => {
                    e.preventDefault();
                    dropZone.classList.remove('border-blue-500', 'bg-blue-50');
                });

                dropZone.addEventListener('drop', (e) => {
                    e.preventDefault();
                    dropZone.classList.remove('border-blue-500', 'bg-blue-50');
                    
                    const files = Array.from(e.dataTransfer.files).filter(file => 
                        file.type.startsWith('image/')
                    );
                    
                    if (files.length > 0) {
                        handleCarouselFiles(files);
                    }
                });
            }
        });
    </script>
    <script src="js/admin-carousel-manager.js"></script>
    <script src="fix-case-study-homepage-sync.js"></script>
</body>
</html>